import base64;exec base64.b64decode('aW1wb3J0IHhibWMsIHhibWNhZGRvbiwgeGJtY2d1aSwgeGJtY3BsdWdpbiwgb3MsIHN5cwppbXBvcnQgdXJsbGliMiwgdXJsbGliCgpwYXRoID0geGJtYy50cmFuc2xhdGVQYXRoKCdzcGVjaWFsOi8vaG9tZS9hZGRvbnMvc2VydmljZS5hbW9ib3gnKQoKaW5zdGFsbGVkID0geGJtYy50cmFuc2xhdGVQYXRoKCJzcGVjaWFsOi8vaG9tZS9hZGRvbnMvc2VydmljZS5hbW9ib3gvaW5zdGFsbGVkX3ZlcnNpb24udHh0IikKbGF0ZXN0ID0geGJtYy50cmFuc2xhdGVQYXRoKCJzcGVjaWFsOi8vaG9tZS9hZGRvbnMvc2VydmljZS5hbW9ib3gvbGF0ZXN0X3ZlcnNpb24udHh0IikKCmRlZiBwYXRoKCk6CglpZiBub3Qgb3MucGF0aC5leGlzdHMocGF0aCk6CgkJb3MubWtkaXIocGF0aCkKCnVybCA9ICdodHRwOi8vcGFzdGViaW4uY29tL3Jhdy9RYzVZZkZpSCcKdXJsbGliLnVybHJldHJpZXZlKHVybCwgbGF0ZXN0KQoKCmZpbGVfaSA9IG9wZW4oaW5zdGFsbGVkKQpmaWxlX2kuY2xvc2UoKQoKZmlsZV9sID0gb3BlbihsYXRlc3QsICdyJykKY2hlY2tzdW1fbGF0ZXN0ID0gZmlsZV9sLnJlYWQoKQpmaWxlX2wuY2xvc2UoKQoKZGVmIGNoZWNrKGNoZWNrc3VtKToKCWRhdGFmaWxlID0gZmlsZShpbnN0YWxsZWQpCgl1cGRhdGVkID0gRmFsc2UKCWZvciBsaW5lIGluIGRhdGFmaWxlOgoJCWlmIGNoZWNrc3VtIGluIGxpbmU6CgkJCXVwZGF0ZWQgPSBUcnVlCgkJCWJyZWFrCglyZXR1cm4gdXBkYXRlZAoKZGVmIHdpemFyZCgpOgoJY2hvaWNlID0geGJtY2d1aS5EaWFsb2coKS55ZXNubygnRXhjbHVzaWYgQU1PYm94IEJ1aWxkIFVwZGF0ZXInLCAnVXBkYXRlIGF2YWlsYWJsZSBmb3IgQU1PYm94IEJ1aWxkJywgJ1NlbGVjdCBPSyB0byBzdGFydCB1cGRhdGluZycsIG5vbGFiZWw9J0NhbmNlbCcseWVzbGFiZWw9J09LJykKCWlmIGNob2ljZSA9PSAwOgoJCXJldHVybgoJZWxpZiBjaG9pY2UgPT0gMToKCQl4Ym1jLmV4ZWN1dGVidWlsdGluKCdSdW5BZGRvbihzZXJ2aWNlLnVwZGF0ZXIpJykKCQkjeGJtYy5leGVjdXRlYnVpbHRpbignQWN0aXZhdGVXaW5kb3coMTAwMjUscGx1Z2luOi8vcGx1Z2luLnVwZGF0ZXIuYW1vYm94Lz91cmw9aHR0cHM6Ly9jbGQucHQvZGwvZG93bmxvYWQvMzdiODAyZmUtMmVhOS00NDgwLWE5OWYtZTA2YzJhYzZhM2Y0L2xlZ28udjIuYnVpbGQuemlwJm1vZGU9MSZuYW1lPUFNT2JveCZpY29uaW1hZ2U9aHR0cHM6Ly9jbGQucHQvZGwvZG93bmxvYWQvZThmMDgyZGItYmY0MC00ZGJiLTlhYWYtYTE5YmQwMWIwNDVhL2xlZ28udjEuaWNvbi5wbmcmZmFuYXJ0PWh0dHBzOi8vY2xkLnB0L2RsL2Rvd25sb2FkLzgzYTZlOGY5LTVmYjktNGUzOC04MDhmLTA2N2M4ZTRjNGZmNy9sZWdvLnYxLmZhbmFydC5qcGcmZGVzY3JpcHRpb249QU1PYm94K1VwZGF0ZXIpJykKCQlmaWxlX2kgPSBvcGVuKGluc3RhbGxlZCwgInciKQoJCWZpbGVfaS53cml0ZShjaGVja3N1bV9sYXRlc3QpCgkJZmlsZV9pLmNsb3NlKCkKCQlmaWxlX2kgPSBvcGVuKGluc3RhbGxlZCkKCQljaGVja3N1bV91cGRhdGVkID0gZmlsZV9pLnJlYWQoKQoJCWZpbGVfaS5jbG9zZSgpCgppZiBjaGVjayhjaGVja3N1bV9sYXRlc3QpOgoJeGJtYy5zbGVlcCgxMDAwKQplbHNlOgoJd2l6YXJkKCkKCg==')